<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>FC-BGP Protocol Specification</title>
<meta content="Ke Xu" name="author">
<meta content="Xiaoliang Wang" name="author">
<meta content="Zhuotao Liu" name="author">
<meta content="Qi Li" name="author">
<meta content="Jianping Wu" name="author">
<meta content="Yangfei Guo" name="author">
<meta content="
       
 This document defines an extension, Forwarding Commitment BGP (FC-BGP), to the Border Gateway Protocol (BGP). FC-BGP provides security for the path of Autonomous Systems (ASs) through which a BGP UPDATE message passes. Forwarding Commitment (FC) is a cryptographically signed segment to certify an AS's routing intent on its directly connected hops. Based on FC, FC-BGP aims to build a secure inter-domain system that can simultaneously authenticate the AS_PATH attribute in the BGP UPDATE message. The extension is backward compatible, which means a router that supports the extension can interoperate with a router that doesn't support the extension. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="draft-wang-sidrops-fcbgp-protocol-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.11.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.1
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-wang-sidrops-fcbgp-protocol.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">FC-BGP</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Xu, et al.</td>
<td class="center">Expires 6 December 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">sidrops</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wang-sidrops-fcbgp-protocol-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-06-04" class="published">4 June 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-12-06">6 December 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Xu</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">X. Wang</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">Z. Liu</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">Q. Li</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">J. Wu</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">Y. Guo</div>
<div class="org">Zhongguancun Laboratory</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">FC-BGP Protocol Specification</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an extension, Forwarding Commitment BGP (FC-BGP), to the Border Gateway Protocol (BGP). FC-BGP provides security for the path of Autonomous Systems (ASs) through which a BGP UPDATE message passes. Forwarding Commitment (FC) is a cryptographically signed segment to certify an AS's routing intent on its directly connected hops. Based on FC, FC-BGP aims to build a secure inter-domain system that can simultaneously authenticate the AS_PATH attribute in the BGP UPDATE message. The extension is backward compatible, which means a router that supports the extension can interoperate with a router that doesn't support the extension.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://FCBGP.github.io/fcbgp-protocol/draft-wang-sidrops-fcbgp-protocol.html">https://FCBGP.github.io/fcbgp-protocol/draft-wang-sidrops-fcbgp-protocol.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wang-sidrops-fcbgp-protocol/">https://datatracker.ietf.org/doc/draft-wang-sidrops-fcbgp-protocol/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/FCBGP/fcbgp-protocol">https://github.com/FCBGP/fcbgp-protocol</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 December 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-definitions-and-acronyms" class="internal xref">Definitions, and Acronyms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-fc-bgp-negotiation" class="internal xref">FC-BGP Negotiation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-fc-path-attribute" class="internal xref">FC Path Attribute</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-fc-bgp-update-messages" class="internal xref">FC-BGP UPDATE Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-generation" class="internal xref">Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-propagation" class="internal xref">Propagation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-processing-instructions-for" class="internal xref">Processing Instructions for AS Confederation Members</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-processing-a-received-fc-bg" class="internal xref">Processing a Received FC-BGP UPDATE Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-validation" class="internal xref">Validation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-validation-algorithm" class="internal xref">Validation Algorithm</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-implementations-operations-" class="internal xref">Implementations, Operations, and Management Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-algorithms-and-extensibilit" class="internal xref">Algorithms and Extensibility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-speedup-and-early-terminati" class="internal xref">Speedup and Early Termination of Signature Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-defering-validation" class="internal xref">Defering Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-bgp-route-selection" class="internal xref">BGP Route Selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-non-deterministic-signature" class="internal xref">Non-deterministic Signature Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-private-as-numbers" class="internal xref">Private AS Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-robustness-considerations-f" class="internal xref">Robustness Considerations for Accessing RPKI Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-graceful-restart" class="internal xref">Graceful Restart</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-robustness-of-secret-random" class="internal xref">Robustness of Secret Random Number in ECDSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-incremental-partial-deploym" class="internal xref">Incremental/Partial Deployment Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-security-guarantees" class="internal xref">Security Guarantees</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-mitigation-of-denial-of-ser" class="internal xref">Mitigation of Denial-of-Service Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-additional-security-conside" class="internal xref">Additional Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-three-as-numbers" class="internal xref">Three AS Numbers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-misc" class="internal xref">MISC</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The FC-BGP mechanism described in this document aims to ensure that advertised routes in BGP <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> are authentic. FC-BGP accomplishes this by introducing a new optional, transitive, and extended length path attribute called FC (Forwarding Commitment) to the BGP UPDATE message. This attribute can be used by an FC-BGP-compliant BGP speaker (referred to hereafter as an FC-BGP speaker) to generate, propagate, and validate BGP UPDATE messages to enhance security. In other words, when the BGP UPDATE message travels through an FC-BGP-enabled AS, it adds a new FC based on the AS order in AS_PATH. Subsequent ASs can then utilize the list of FCs in the BGP UPDATE message to ensure that the advertised path is consistent with the AS_PATH attribute.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">BGPsec is a path-level authentication approach described in <span>[<a href="#RFC8205" class="cite xref">RFC8205</a>]</span>. It replaces the AS_PATH attribute, which is used to record the sequence of autonomous systems (ASes) that a BGP update has traversed, with the non-transitive BGPsec_Path attribute. However, when a peer does not support BGPsec, the BGPsec_Path attribute will be downgraded to the standard AS_PATH attribute, losing the security benefits provided by BGPsec. In contrast, FC-BGP (Forwarding Commitment Driven BGP) preserves the AS_PATH attribute and introduces an additional list of signed messages called Forwarding Commitments. Each Forwarding Commitment (FC) is a publicly verifiable code certifying the correctness of a three-hop pathlet. FC-BGP builds its path authentication based on these FCs.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">FC-BGP and BGPsec offer different levels of security benefits in the case of partial deployment, even though they achieve the same security benefits when fully deployed. BGPsec tightly couples path authentication with the BGP path construction process, requiring each AS to iteratively verify the signatures of each prior hop before extending the authentication chain. Consequently, a single legacy AS that does not support BGPsec can break the authentication chain, preventing subsequent BGPsec-aware ASes from reviving the authentication process. As a result, in partial deployment scenarios, BGPsec is often downgraded to the legacy BGP protocol, losing its security benefits.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In contrast to BGPsec, FC-BGP treats partial deployability as a first-class citizen. It adopts a pathlet-driven authentication paradigm, in which the authenticity of an AS-path can be incrementally built based on authenticated pathlets.  This design ensures that downstream FC-BGP-aware ASes can use the authenticated pathlets provided by upstream upgraded ASes, even if the full AS-path traverses legacy ASes that do not support FC-BGP. By allowing the authentication of sub-paths, FC-BGP enables incremental deployment and provides security benefits to the FC-BGP-aware ASes, regardless of the deployment status of other ASes on the path.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Similar to BGPsec, FC-BGP relies on RPKI to perform route origin validation <span>[<a href="#RFC6483" class="cite xref">RFC6483</a>]</span>. Additionally, any FC-BGP speaker that wishes to process the FC path attribute along with BGP UPDATE messages <span class="bcp14">MUST</span> obtain a router certificate and store it in the RPKI repository. This certificate is associated with its AS number. The router key generation here follows <span>[<a href="#RFC8208" class="cite xref">RFC8208</a>]</span> and <span>[<a href="#RFC8635" class="cite xref">RFC8635</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">It is <span class="bcp14">NOT RECOMMENDED</span> to enable both BGPsec and FC-BGP simultaneously in a BGP network. However, if a BGP update message contains both BGPsec and FC-BGP features, the BGP speaker should process the message properly. In such cases, the BGP speaker should prioritize BGPsec over FC-BGP. This means that if a BGP update message includes the BGPsec_PATH attribute, a BGP speaker that supports both BGPsec and FC-BGP should use the Secure_Path instead of the AS_PATH to generate or verify the FC segments. This prioritization ensures that the security benefits of BGPsec are not compromised by the presence of FC-BGP in the same update message.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions-and-acronyms">
<section id="section-1.2">
        <h3 id="name-definitions-and-acronyms">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-definitions-and-acronyms" class="section-name selfRef">Definitions, and Acronyms</a>
        </h3>
<p id="section-1.2-1">The following terms are used with a specific meaning:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.2-2">
          <dt id="section-1.2-2.1">BGP neighbor:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">Also just 'neighbor'. Two BGP speakers that communicate using the BGP protocols are neighbors. It can be divided into iBGP neighbor and eBGP neighbor.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.3">BGP speaker:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.4">
            <p id="section-1.2-2.4.1">A device, usually a router, exchanging routes with other BGP speakers using the BGP protocol.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.5">BGP UPDATE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.6">
            <p id="section-1.2-2.6.1">The message is generated with several path attributes to advertise routes.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.7">iBGP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.8">
            <p id="section-1.2-2.8.1">iBGP neighbor, internal BGP neighbor, or internal neighbor. Internal neighbors are in the same AS.<a href="#section-1.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.9">eBGP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.10">
            <p id="section-1.2-2.10.1">eBGP neighbor, external BGP neighbor, or external neighbor. External neighbors are in different ASs.<a href="#section-1.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.11">Router:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.12">
            <p id="section-1.2-2.12.1">In this document, the router always refers to a BGP speaker.<a href="#section-1.2-2.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-3">In addition to the list above, the following terms are used in this document:<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.2-4">
          <dt id="section-1.2-4.1">FC:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">Forwarding Commitment, i.e., FC segment. It contains several fields and a digital signature to protect the current path.<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.3">FCList:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.4">
            <p id="section-1.2-4.4.1">An ordered list of FC segments to protect the whole AS-Path in the BGP UPDATE message. The order of FCs follows the order of AS numbers in the AS-Path. All FC-BGP-enabled BGP speakers <span class="bcp14">SHOULD</span> add their FCs to the BGP UPDATE message.<a href="#section-1.2-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.5">FC path attribute:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.6">
            <p id="section-1.2-4.6.1">The optional, transitive, extended length path attribute is defined in this document to obtain BGP security.<a href="#section-1.2-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.7">FC-BGP UPDATE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.8">
            <p id="section-1.2-4.8.1">A BGP UPDATE message carries the FC path attribute.<a href="#section-1.2-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.9">FC-BGP speaker:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.10">
            <p id="section-1.2-4.10.1">A BGP speaker that enables the FC-BGP feature. It can generate, propagate, and validate FC-BGP UPDATE messages.<a href="#section-1.2-4.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="fc-bgp-negotiation">
<section id="section-2">
      <h2 id="name-fc-bgp-negotiation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-fc-bgp-negotiation" class="section-name selfRef">FC-BGP Negotiation</a>
      </h2>
<p id="section-2-1">FC-BGP does not need to negotiate with neighbors since it is considered a transitive path attribute within the BGP UPDATE message. BGP speakers that do not recognize the FC path attribute or do not support FC-BGP, <span class="bcp14">SHOULD</span> still transmit the FC path attribute to their neighbors. As a result, there is no need to establish a new BGP capability as defined in <span>[<a href="#RFC5492" class="cite xref">RFC5492</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fc-path-attribute">
<section id="section-3">
      <h2 id="name-fc-path-attribute">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-fc-path-attribute" class="section-name selfRef">FC Path Attribute</a>
      </h2>
<p id="section-3-1">Unlike BGPsec, FC-BGP does not modify the AS_PATH. Instead, FC is enclosed in a BGP UPDATE message as an optional, transitive, and extended length path attribute. This document registers a new attribute type code for this attribute: TBD, see <a href="#iana-considerations" class="auto internal xref">Section 8</a> for more information.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The FC path attribute includes the digital signatures that protect the pathlet information. We refer to those update messages that contain the FC path attribute as "FC-BGP UPDATE messages". Although FC-BGP would not modify the AS_PATH path attribute, it is <span class="bcp14">REQUIRED</span> to never use the AS_SET or AS_CONFED_SET in FC-BGP according to <span>[<a href="#RFC6472" class="cite xref">RFC6472</a>]</span>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The format of the FC path attribute is shown in <a href="#figure1" class="auto internal xref">Figure 1</a> and <a href="#figure2" class="auto internal xref">Figure 2</a>. <a href="#figure1" class="auto internal xref">Figure 1</a> shows the format of FC path attribute and <a href="#figure2" class="auto internal xref">Figure 2</a> shows the FC segment format.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-format-of-fc-path-attribute"></span><div id="figure1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Flags    |      Type     |         FCList Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                            FCList                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-format-of-fc-path-attribute" class="selfRef">Format of FC path attribute.</a>
        </figcaption></figure>
</div>
<p id="section-3-5">FC path attribute includes the following parts:<a href="#section-3-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-6">
        <dt id="section-3-6.1">Flags (1 octet):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.2">
          <p id="section-3-6.2.1">The current value is 0b11010000, representing the FC path attribute as optional, transitive, partial, and extended-length.<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.3">Type (1 octet):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.4">
          <p id="section-3-6.4.1">The current value is TBD. Refer to <a href="#iana-considerations" class="auto internal xref">Section 8</a> for more information.<a href="#section-3-6.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.5">FCList Length (2 octets):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.6">
          <p id="section-3-6.6.1">The value is the total length of the FCList in octets.<a href="#section-3-6.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.7">FCList (variable length):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.8">
          <p id="section-3-6.8.1">The value is a sequence of FC segments, in order. The definition of the FC segment format is shown in <a href="#figure2" class="auto internal xref">Figure 2</a>. It does not conflict with the AS_PATH attribute. That means the FC-BGP path attribute and AS_PATH attribute can coexist in the same FC-BGP UPDATE message.<a href="#section-3-6.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<span id="name-format-of-fc-segment"></span><div id="figure2">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-3-7.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                Previous Autonomous System Number              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Current Autonomous System Number              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Nexthop Autonomous System Number              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                     Subject Key Identifier                    ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Algorithm ID  |      Flags    |       Signature Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                          Signature                            ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-format-of-fc-segment" class="selfRef">Format of FC segment.</a>
        </figcaption></figure>
</div>
<p id="section-3-8">In FC-BGP, all ASs <span class="bcp14">MUST</span> use 4-byte AS numbers in FC segments. Existing 2-byte AS numbers are converted into 4-byte AS numbers by setting the two high-order octets of the 4-octet field to 0 <span>[<a href="#RFC6793" class="cite xref">RFC6793</a>]</span>.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">FC segment includes the following parts. (See <a href="#fcbgp-update" class="auto internal xref">Section 4</a> for more details on populating these fields.)<a href="#section-3-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-10">
        <dt id="section-3-10.1">Previous Autonomous System Number (PASN, 4 octets):</dt>
        <dd style="margin-left: 1.5em" id="section-3-10.2">
          <p id="section-3-10.2.1">The PASN is the AS number of the previous hop AS from whom the FC-BGP speaker receives the FC-BGP UPDATE message. If the current AS has no previous AS hop, it <span class="bcp14">MUST</span> be filled with 0. It will be discussed more at <a href="#sec-three-asn" class="auto internal xref">Section 7.3.1</a>.<a href="#section-3-10.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-10.3">Current Autonomous System Number (CASN, 4 octets):</dt>
        <dd style="margin-left: 1.5em" id="section-3-10.4">
          <p id="section-3-10.4.1">The CASN is the AS number of the FC-BGP speaker that added this FC segment to the FC path attribute.<a href="#section-3-10.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-10.5">Nexthop Autonomous System Number (NASN, 4 octets):</dt>
        <dd style="margin-left: 1.5em" id="section-3-10.6">
          <p id="section-3-10.6.1">The NASN is the AS number of the next hop AS to whom the FC-BGP speaker will send the BGP UPDATE message.<a href="#section-3-10.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-10.7">Subject Key Identifier (SKI, 20 octets):</dt>
        <dd style="margin-left: 1.5em" id="section-3-10.8">
          <p id="section-3-10.8.1">The SKI in the RPKI router certificate is a unique identifier for the public key used for signature verification. If the SKI length exceeds 20 octets, it should retrieve the leftmost 20 octets.<a href="#section-3-10.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3-11">
        <dt id="section-3-11.1">Algorithm ID (1 octet):</dt>
        <dd style="margin-left: 1.5em" id="section-3-11.2">
          <p id="section-3-11.2.1">The current assigned value is 1, indicating that SHA256 is used to hash the content to be signed, and ECDSA is used for signing. It follows the algorithm suite defined in <span>[<a href="#RFC8208" class="cite xref">RFC8208</a>]</span> and its updates. Each FC segment has an Algorithm ID, so there is no need to worry about sudden changes in its algorithm suite. The key in FC-BGP uses the BGPsec Router Key, so its generation and management follow <span>[<a href="#RFC8635" class="cite xref">RFC8635</a>]</span>.<a href="#section-3-11.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3-12">
        <dt id="section-3-12.1">Flags (1 octet):</dt>
        <dd style="margin-left: 1.5em" id="section-3-12.2">
          <p id="section-3-12.2.1">Several flag bits. The leftmost bit of the Flags field in <a href="#figure2" class="auto internal xref">Figure 2</a> is the Confed_Segment flag (Flags-CS). The Flags-CS flag is set to 1 to indicate that the FC-BGP speaker that constructed this FC segment is sending the UPDATE message to a peer AS within the same AS confederation <span>[<a href="#RFC5065" class="cite xref">RFC5065</a>]</span>. (That is, a sequence of consecutive Confed_Segment flags are set in an FC-BGP UPDATE message whenever, in a non-FC-BGP UPDATE message, an AS_PATH segment of type AS_CONFED_SEQUENCE occurs.) In all other cases, the Flags-CS flag is set to 0. The second leftmost bit (i.e., the second highest) of the Flags field in <a href="#figure2" class="auto internal xref">Figure 2</a> is the Route_Server flag (Flags-RS). The Flags-RS flag is set to 1 to indicate that the FC segment is added by a route server, but the AS number will never appear in the AS_PATH attribute. The remaining 6-bit of the Flags field are unassigned. They <span class="bcp14">MUST</span> be set to 0 by the sender and ignored by the receiver.<a href="#section-3-12.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-12.3">Signature Length (2 octets):</dt>
        <dd style="margin-left: 1.5em" id="section-3-12.4">
          <p id="section-3-12.4.1">It only contains the length of the Signature field in octets, not including other fields.<a href="#section-3-12.4.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlNewline" id="section-3-13">
        <dt id="section-3-13.1">Signature (variable length):</dt>
        <dd style="margin-left: 1.5em" id="section-3-13.2">
          <p id="section-3-13.2.1">The signature content and order are Signature=ECDSA(SHA256(PASN, CASN, NASN, Prefix, Prefix Length)), where the Prefix is the IP address prefix which is encapsulated in the BGP UPDATE, i.e. NLRI, and only one prefix is used each time. When hashing and signing, the full IP address and IP prefix length are used, i.e., IPv4 uses 4 octets and IPv6 uses 16 octets.<a href="#section-3-13.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="fcbgp-update">
<section id="section-4">
      <h2 id="name-fc-bgp-update-messages">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-fc-bgp-update-messages" class="section-name selfRef">FC-BGP UPDATE Messages</a>
      </h2>
<div id="generation">
<section id="section-4.1">
        <h3 id="name-generation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-generation" class="section-name selfRef">Generation</a>
        </h3>
<p id="section-4.1-1">This part defines the generation of the FC path attribute and the FC segment. An FC-BGP speaker <span class="bcp14">SHOULD</span> generate a new FC segment or even a new FC path attribute when it propagates a route to its external neighbors. For internal neighbors, the FC path attribute in the BGP UPDATE message remains unchanged.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The FC-BGP speaker follows a specific process to create the FC path attribute for the ongoing UPDATE message. Firstly, it generates a new FC Segment containing the necessary information for the FC path. This new FC Segment is then added to the FCList of the outer format defined in <a href="#figure1" class="auto internal xref">Figure 1</a>. It is important to note that if the FC-BGP speaker is not the origin AS and there is already an existing FC path attribute of the UPDATE message, it <span class="bcp14">MUST</span> prepend its new FC segment to the FCList of the existing FC path attribute like the insertion process of ASN in AS_PATH attribute. This allows the FC-BGP speaker to contribute to its own FC segment while maintaining the existing FC path information. Otherwise, if it is the source AS, the FC-BGP speaker generates the FC path attribute defined in <a href="#figure1" class="auto internal xref">Figure 1</a> and inserts it into the UPDATE message.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">There are three AS numbers in one FC segment as <a href="#figure2" class="auto internal xref">Figure 2</a> shows. The populating of the Current AS number (CASN) within the FC segment is like the AS number in BGPsec, it <span class="bcp14">MUST</span> match the AS number in the Subject field of the RPKI router certificate that will be used to verify the FC segment constructed by this FC-BGP speaker (see <span><a href="https://rfc-editor.org/rfc/rfc8209#section-3.1.1" class="relref">Section 3.1.1</a> of [<a href="#RFC8209" class="cite xref">RFC8209</a>]</span> and <span>[<a href="#RFC6487" class="cite xref">RFC6487</a>]</span>). The Previous AS number (PASN) is typically set to the AS number from which the UPDATE message receives. However, if the FC-BGP speaker is located in the origin AS, the PASN <span class="bcp14">SHOULD</span> be filled with 0. The Nexthop AS number (NASN) is set to the AS number of the peer to whom the route is advertised. So if there are several neighbors, the FC-BGP speaker should generate separate FCs for different neighbors. But it would never generate a new FC segment for the iBGP neighbor.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">The Subject Key Identifier field (SKI) within the new FC segment is populated with the identifier found in the Subject Key Identifier extension of the RPKI router certificate associated with the FC-BGP speaker. This identifier serves as a crucial piece of information for recipients of the route advertisement. It enables them to identify the appropriate certificate to employ when verifying the signatures in FC segments attached to the route advertisement. This practice adheres to the guidelines outlined in <span>[<a href="#RFC8209" class="cite xref">RFC8209</a>]</span>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Typically, the Flags field is set to 0.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">A route server (RS) is a third-party brokering system that interconnects three or more BGP-speaking routers using eBGP in IXPs <span>[<a href="#RFC7947" class="cite xref">RFC7947</a>]</span>. Typically, RS performs like a transit AS except that it does not insert its AS number to the AS_PATH attribute. The route server also can participate in the FC-BGP process. If the RS is an FC-BGP-enabled RS, it may choose to set the Flags-RS bit to 1 when it populates its FC segment. However, when the RS chooses to add its AS number to the AS_PATH attribute, the Flags-RS bit <span class="bcp14">SHOULD</span> be set to 0. If the RS is a non-FC-BGP RS, it propagates the FC-BGP UPDATE message directly. Anyway, the AS number of RS would be used in the FC segment no matter if it appears in the AS_PATH attribute.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">AS Path Prepending is a traffic engineering mechanism in BGP to deprioritize a route or alternate path, which will prepend the local AS number multiple times to the AS_PATH attribute <span>[<a href="#ASPP" class="cite xref">ASPP</a>]</span>. To minimize unnecessary processing load during the validation of FC segments, an FC-BGP speaker <span class="bcp14">SHOULD NOT</span> generate multiple consecutive FC segments with the same AS number. Instead, the FC-BGP speaker <span class="bcp14">SHOULD</span> aim to produce a single FC segment once, even if the intention is to achieve the semantics of prepending the same AS number multiple times.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The Algorithm ID field is set to 1. FC-BGP only supports one algorithm suite in this document as BGPsec Algorithm defined in <span>[<a href="#RFC8208" class="cite xref">RFC8208</a>]</span>. That is the signature algorithm used <span class="bcp14">MUST</span> be the Elliptic Curve Digital Signature Algorithm (ECDSA) with curve P-256 and the hash algorithm used <span class="bcp14">MUST</span> be SHA-256. If it transits from one algorithm suite to another, the FC-BGP speaker <span class="bcp14">MUST</span> place its router certificate in the RPKI repository first and then specify the Algorithm ID in the FC segment.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">The Signature Length field is populated with the length (in octets) of the value in the Signature field.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">The Signature field in the new FC segment is a variable length field. It contains a digital signature encapsulated in DER format that binds the prefix, its length, and triplet &lt;PASN, CASN, NASN&gt; to the RPKI router certificate corresponding to the FC-BGP speaker. The digital signature is computed as follows: Signature=ECDSA(SHA256(PASN, CASN, NASN, Prefix, Prefix Length))<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">The signatures within the FC segments of an FC-BGP UPDATE message ensure the protection of crucial information including the AS number of the neighbor involved in the message exchange. This information is explicitly included in the generated FC segment. Consequently, if an FC-BGP speaker intends to transmit an FC-BGP UPDATE message to multiple BGP neighbors, it <span class="bcp14">MUST</span> generate a distinct FC-BGP UPDATE message for each unique neighbor AS to whom the UPDATE message is being sent.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">Indeed, an FC-BGP UPDATE message is <span class="bcp14">REQUIRED</span> to advertise a route to just one prefix. This is because if an FC-BGP speaker receives an UPDATE message containing multiple prefixes, it would be unable to construct a valid FC-BGP UPDATE message, including valid path signatures, with a subset of the received prefixes. To advertise routes to multiple prefixes, the FC-BGP speaker <span class="bcp14">MUST</span> generate individual FC-BGP UPDATE messages for each prefix. This ensures the proper construction of valid path signatures for each advertised prefix.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1-13">All FC-BGP UPDATE messages <span class="bcp14">MUST</span> conform to BGP's maximum message size. If the resulting message exceeds the maximum message size, then the guidelines in <span><a href="https://rfc-editor.org/rfc/rfc4271#section-9.2" class="relref">Section 9.2</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> <span class="bcp14">MUST</span> be followed.<a href="#section-4.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="propagation">
<section id="section-4.2">
        <h3 id="name-propagation">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-propagation" class="section-name selfRef">Propagation</a>
        </h3>
<p id="section-4.2-1">Any BGP speaker should propagate the optional transitive FC path attribute encapsulated in the FC-BGP UPDATE message, even though they do not support the FC-BGP feature. However, it is important to note that an FC-BGP speaker <span class="bcp14">SHOULD NOT</span> make any attestation regarding the validation state of the FC-BGP UPDATE message it receives. They <span class="bcp14">MUST</span> verify the FC path attribute themselves.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">To incorporate or create a new FC segment for an FC-BGP UPDATE message using a specific algorithm suite, the FC-BGP speaker <span class="bcp14">MUST</span> possess an appropriate private key capable of generating signatures for that particular algorithm suite. Moreover, this private key <span class="bcp14">MUST</span> correspond to the public key found in a valid RPKI End Entity (EE) certificate. The AS number resource extension within this certificate should include the FC-BGP speaker's AS number as specified in <span>[<a href="#RFC8209" class="cite xref">RFC8209</a>]</span>. It is worth noting that these new segments are only prepended to an FC-BGP UPDATE message when the FC-BGP speaker generates the UPDATE message for transmission to an external neighbor. In other words, this occurs when the AS number of the neighbor differs from the AS number of the FC-BGP speaker.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The RPKI allows the legitimate holder of IP address prefix(es) to issue a digitally signed object known as a Route Origin Authorization (ROA). This ROA authorizes a specific AS to originate routes for a particular set of prefixes <span>[<a href="#RFC6482" class="cite xref">RFC6482</a>]</span>. It is anticipated that most Relying Parties (RPs) will combine FC-BGP with origin validation <span>[<a href="#RFC6483" class="cite xref">RFC6483</a>]</span> and <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>. Therefore, it is strongly <span class="bcp14">RECOMMENDED</span> that an FC-BGP speaker only advertises a route for a given prefix in an FC-BGP UPDATE message if there is a valid ROA that authorizes the FC-BGP speaker's AS to originate routes for that specific prefix.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">If an FC-BGP router receives a non-FC-BGP UPDATE message from an external neighbor, meaning that the origin BGP speaker does not support FC-BGP, the router processes the UPDATE message as a regular BGP UPDATE message typically. In this case, it <span class="bcp14">SHOULD NOT</span> add its own FC segment to the UPDATE message. On the other hand, when the FC-BGP speaker advertises routes belonging to its local AS and receives them from an internal neighbor, it <span class="bcp14">MUST</span> add its FC segment to the UPDATE message if it decides to propagate those routes. Furthermore, if the FC-BGP router receives an FC-BGP UPDATE message from a neighbor for a specific prefix and chooses to propagate that neighbor's route for the prefix, it <span class="bcp14">MUST</span> propagate the route as an FC-BGP UPDATE message containing the FC path attribute.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">When an FC-BGP speaker sends an FC-BGP UPDATE message to an iBGP (internal BGP) neighbor, the process is straightforward. When the FC-BGP speaker originates a new route advertisement and sends it to an iBGP neighbor, it <span class="bcp14">MUST NOT</span> include the FC path attribute of the UPDATE message. In other words, the FC-BGP speaker omits the FC path attribute. Similarly, when an FC-BGP speaker decides to forward an FC-BGP UPDATE message to an iBGP neighbor, it <span class="bcp14">MUST</span> refrain from adding a new FC segment to the FC-BGP UPDATE message.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">When an FC-BGP speaker receives an FC-BGP UPDATE message containing an FC path attribute (with one or more FC segments) from an (internal or external) neighbor, it may choose to propagate the route advertisement by sending it to its other (internal or external) neighbors. When sending the route advertisement to an internal FC-BGP-speaking neighbor, the FC path attribute <span class="bcp14">SHALL NOT</span> be modified. When sending the route advertisement to an external FC-BGP-speaking neighbor, the following procedures are used to form or update the FC path attribute.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-instructions-for-as-confederation-members">
<section id="section-4.3">
        <h3 id="name-processing-instructions-for">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-processing-instructions-for" class="section-name selfRef">Processing Instructions for AS Confederation Members</a>
        </h3>
<p id="section-4.3-1">Members of AS Confederation <span>[<a href="#RFC5065" class="cite xref">RFC5065</a>]</span> <span class="bcp14">MUST</span> additionally follow the instructions in this section for processing FC-BGP UPDATE messages.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">When an FC-BGP speaker in an AS confederation receives an FC-BGP UPDATE message from a neighbor that is external to the confederation and chooses to propagate the UPDATE message within the confederation, it first adds an FC segment and the signature signed to its own Member-AS (i.e., the 'Current AS Number' is the FC-BGP speaker's Member-AS Number). In this internally modified UPDATE message, the newly added FC segment contains the public AS number (i.e., Confederation Identifier), and the segment's Confed_Segment flag is set to 1. The newly added signature is generated using a private key corresponding to the public AS number of the confederation. The FC-BGP speaker propagates the modified UPDATE message to its peers within the confederation. (Note: In this document, intra-Member-AS peering is regarded as iBGP, and inter-Member-AS peering is regarded as eBGP. The latter is also known as confederation-eBGP.)<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Within a confederation, the verification of FC-BGP signatures added by other members of the confederation is optional. Note that if a confederation chooses not to verify digital signatures within the confederation, then FC-BGP is not able to provide any assurances about the integrity of the Member-AS Numbers placed in FC segments where the Confed_Segment flag is set to 1.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">When a confederation member receives an FC-BGP UPDATE message from a peer within the confederation and propagates it to a peer outside the confederation, it needs to remove all of the FC segments added by confederation members when it removes all path segments of the AS_PATH with the type of AS_CONFED_SEQUENCE or AS_CONFED_SET. To do this, the confederation members propagated the route outside the confederation the following:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-5">
<li id="section-4.3-5.1">
            <p id="section-4.3-5.1.1">Starting with the most recently added FC segment, remove FC segments whose Flags-CS bit is 1. Stop this process once an FC segment that has its Confed_Segment flags set to 0 is reached.<a href="#section-4.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-5.2">
            <p id="section-4.3-5.2.1">Add an FC segment containing, in the CASN field, the AS Confederation Identifier (the public AS number of the confederation).  Note that all fields other than the CASN field are populated.<a href="#section-4.3-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-6">Finally, as discussed above, an AS confederation <span class="bcp14">MAY</span> optionally decide that its members will not verify digital signatures added by members. In such a confederation, when an FC-BGP speaker runs the algorithm in <a href="#validation-steps" class="auto internal xref">Section 5.2.1</a>, the FC-BGP speaker, during the process of signature verifications, first checks whether the Confed_Segment flag in an FC segment is set to 1. If the flag is set to 1, the FC-BGP speaker skips the verification for the corresponding signature and immediately moves on to the next FC segment. It is an error when an FC-BGP speaker receives, from a neighbor who is not in the same AS confederation, an FC-BGP UPDATE message containing a Confed_Segment flag set to 1.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="processing-a-received-fc-bgp-update-message">
<section id="section-5">
      <h2 id="name-processing-a-received-fc-bg">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-processing-a-received-fc-bg" class="section-name selfRef">Processing a Received FC-BGP UPDATE Message</a>
      </h2>
<div id="overview">
<section id="section-5.1">
        <h3 id="name-overview">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-5.1-1">When receiving an FC-BGP UPDATE message from an external BGP neighbor carrying the FC path attribute, an FC-BGP speaker <span class="bcp14">SHOULD</span> first validate the message to determine the authenticity of the path information. Same as BGPsec, an FC-BGP speaker will wish to perform origin validation (see <span>[<a href="#RFC6483" class="cite xref">RFC6483</a>]</span> and <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>) on an incoming FC-BGP UPDATE message, but such validation is independent of the validation described in this section.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">After the validation, the FC-BGP speaker may want to send the FC-BGP UPDATE message to neighbors according to local route policies. Then It <span class="bcp14">SHOULD</span> update the FC path attributes and continue advertising the BGP route.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">For the origin AS who launches the advertisement, the FC-BGP speaker only needs to generate the FC-BGP UPDATE message other than the validation.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The FC-BGP speaker stores the router certificates in the RPKI repository, and any changes in the RPKI state can impact the validity of the UPDATE messages. That means the validity of FC-BGP UPDATE messages relies on the current state of the RPKI repository. When an FC-BGP speaker becomes aware of a change in the RPKI state, such as through an RPKI validating cache using the RTR protocol (as specified in <span>[<a href="#RFC8210" class="cite xref">RFC8210</a>]</span>), it is <span class="bcp14">REQUIRED</span> to rerun validation on all affected UPDATE messages stored in its Adj-RIB-In <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>. For instance, if a specific RPKI router certificate becomes invalid due to expiration or revocation, all FC-BGP UPDATE messages containing an FC segment with an SKI matching the SKI in the affected certificate must be reassessed to determine their current validity. If the reassessment reveals a change in the validity state of an UPDATE message, the FC-BGP speaker, depending on its local policy, <span class="bcp14">SHOULD</span> need to rerun the best path selection process. This allows for the appropriate handling of the updated information and ensures that the most valid and suitable paths are chosen for routing purposes.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validation">
<section id="section-5.2">
        <h3 id="name-validation">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-validation" class="section-name selfRef">Validation</a>
        </h3>
<p id="section-5.2-1">When verifying the authenticity of an FC-BGP UPDATE message, information from the RPKI router certificates is utilized. The RPKI router certificates provide the data including the triplet &lt;AS Number, Public Key, Subject Key Identifier&gt; to verify the AS_PATH and FC path attributes. As a prerequisite, the recipient <span class="bcp14">SHOULD</span> have access to these RPKI router certificates.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Note that the FC-BGP speaker could perform the validation of RPKI router certificates on its own and extract the required data, or it could receive the same data from a trusted cache that performs RPKI validation on behalf of (some set of) FC-BGP speakers. (For example, the trusted cache could deliver the necessary validity information to the FC-BGP speaker by using the Router Key PDU (Protocol Data Unit) for the RPKI-Router protocol <span>[<a href="#RFC8210" class="cite xref">RFC8210</a>]</span>.)<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The recipient validates an FC-BGP UPDATE message containing the FC path attribute and obtains one result of two states: 'Valid' and 'Not Valid'. We will describe the validation procedure in <a href="#validation-steps" class="auto internal xref">Section 5.2.1</a> in this document. The validation result will be used at BGP route selection, thus it will be discussed at <a href="#BGP-route-selection" class="auto internal xref">Section 6.4</a>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">As the FC-BGP UPDATE message generates at the eBGP router, the FC-BGP validation needs only to be performed at the eBGP router. The iBGP route plays a crucial role in the FC-BGP UPDATE message propagation and distribution. The function of iBGP is to convey the validation status of an FC-BGP UPDATE message from an ingress edge router to an egress edge router within an AS. The specific mechanisms used to convey the validation status can vary depending on the implementation and local policies of the AS. By propagating this information through iBGP, the eBGP router, and other routers within the AS, can be aware of the validation status of the FC-BGP UPDATE messages and make routing decisions accordingly. As stated in <a href="#fcbgp-update" class="auto internal xref">Section 4</a>, when an FC-BGP speaker decides to forward a syntactically correct FC-BGP UPDATE message, it is <span class="bcp14">RECOMMENDED</span> to do so while preserving the FC path attribute. This recommendation applies regardless of the validation state of the UPDATE message.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">Ultimately, the decision to forward the FC-BGP UPDATE message with the FC path intact and the choice to perform independent validation at the egress router are both determined by local policies implemented within the AS. Note that the decision to perform validation on the received FC-BGP UPDATE message is left to the discretion of the egress router, which is the router receiving the message within its own AS. The egress router has the freedom to choose whether or not it wants to independently validate the FC path attribute based on its local policy, even if the FC path attribute has already been validated by the ingress router. This additional validation performed at the egress router helps ensure the integrity and security of the received FC-BGP UPDATE message.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div id="validation-steps">
<section id="section-5.2.1">
          <h4 id="name-validation-algorithm">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-validation-algorithm" class="section-name selfRef">Validation Algorithm</a>
          </h4>
<p id="section-5.2.1-1">This section specifies the concrete validation algorithm of FC-BGP UPDATE messages. A compliant implementation <span class="bcp14">MUST</span> have an FC-BGP UPDATE validation algorithm that behaves the same as the specified algorithm. This ensures consistency and security in validating FC-BGP UPDATE messages across different implementations. It allows for interoperability and standardized communication between FC-BGP-enabled networks.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">First, the integrity of the FC-BGP UPDATE message <span class="bcp14">MUST</span> be checked. Both syntactical and protocol violation errors are checked. The FC path attribute <span class="bcp14">MUST</span> be present when an FC-BGP UPDATE message is received from an external FC-BGP neighbor and also when such an UPDATE message is propagated to an internal FC-BGP neighbor. The error checks specified in <span><a href="https://rfc-editor.org/rfc/rfc4271#section-6.3." class="relref">Section 6.3.</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> are performed, except that for FC-BGP UPDATE messages the checks on the FC path attribute do not apply and instead, the following checks on the FC path attribute are performed:<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-3">
<li id="section-5.2.1-3.1">
              <p id="section-5.2.1-3.1.1">Check to ensure that the entire FC path attribute is syntactically correct (conforms to the specification in this document).<a href="#section-5.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.1-3.2">
              <p id="section-5.2.1-3.2.1">Check that the triplet &lt;PASN, CASN, NASN&gt; fields in each FC segment follow the order in AS_PATH.<a href="#section-5.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.1-3.3">
              <p id="section-5.2.1-3.3.1">Check that each FC segment contains one signature with the supported Algorithm ID.<a href="#section-5.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.1-3.4">
              <p id="section-5.2.1-3.4.1">If the UPDATE message was received from an FC-BGP neighbor that is not a member of the FC-BGP speaker's AS confederation, check to ensure that none of the FC Segments contain a Flags field with the Confed_Segment flag set to 1.<a href="#section-5.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.1-3.5">
              <p id="section-5.2.1-3.5.1">If the UPDATE message was received from an FC-BGP neighbor that is a member of the FC-BGP speaker's AS confederation, check to ensure that the FC Segment corresponding to that peer contains a Flags field with the Confed_Segment flag set to 1.<a href="#section-5.2.1-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.1-3.6">
              <p id="section-5.2.1-3.6.1">If the UPDATE message was received from a neighbor that is not expected to set Flags-RS bit to 1 (see <a href="#fcbgp-update" class="auto internal xref">Section 4</a>), then check to ensure that the Flags-RS bit in the most recently added FC Segment is not equal to 0.<a href="#section-5.2.1-3.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.2.1-4">If any of the checks for the FC path attribute fail, indicating a syntactical or protocol error, it is considered an error. In such cases, FC speakers are <span class="bcp14">REQUIRED</span> to handle these errors using the "treat-as-withdraw" approach as defined in <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>. This approach means that the FC-BGP speaker <span class="bcp14">SHOULD</span> treat the FC path attribute as if it were a withdraw message, effectively removing the route from consideration. It's worth noting that when a transparent route server is involved, and its AS number appears in the FC (with the Flags-RS bit set to 1), the route server has the option to check if its local AS is listed in the FC. This additional check can be included as part of the loop-detection mechanism mentioned earlier in the specification.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">Next, the FC-BGP speaker iterates through the FC segments. Once the FC-BGP speaker has examined the signature field in the FC attribute, it proceeds to validate the signature using the supported algorithm suites. However, if the FC-BGP speaker encounters a signature corresponding to an algorithm suite indexed by an Algorithm ID that it does not support, that particular signature is not considered in the validation process. If there are no signatures corresponding to any algorithm suites supported by the FC-BGP speaker, a specific action is taken to ensure the continuity of the route selection process. To consider the UPDATE message in the route selection process, the FC-BGP speaker has to treat the message as if it were received as an unsigned BGP UPDATE message. By treating the UPDATE message as unsigned, the FC-BGP speaker acknowledges that it cannot verify the integrity and authenticity of the message through the provided signatures. However, it still allows the message to be considered for route selection, ensuring that important routing information is not disregarded solely due to the lack of supported signature algorithms.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
<p id="section-5.2.1-6">For each remaining signature corresponding to an algorithm suite supported by the FC-BGP speaker, the FC-BGP speaker processes FC-BGP UPDATE message validation with the following steps. As different FC segments are independent, it is recommended to verify FC segments parallelly.<a href="#section-5.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-7.1">
              <p id="section-5.2.1-7.1.1">Step 1: Locate the public key needed to verify the signature in the current FC segment. To do this, consult the valid RPKI router certificate data and look up all valid &lt;AS Number, Public Key, Subject Key Identifier&gt; triples in which the AS matches the Current AS Number (CASN) in the corresponding FC segment. Of these triples that match the AS number, check whether there is a SKI that matches the value in the Subject Key Identifier field of the FC segment.  If this check finds no such matching SKI value, then mark the entire FC segment as 'Not Valid' and stop.<a href="#section-5.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.1-7.2">
              <p id="section-5.2.1-7.2.1">Step 2: Compute the digest function (for the given algorithm suite) on the appropriate data. To verify the digital signature in the FC segment, construct the sequence of octets to be hashed. Note that this sequence is the same sequence that was used by AS that created the FC Segment (see <a href="#fcbgp-update" class="auto internal xref">Section 4</a>). The elements in this sequence <span class="bcp14">MUST</span> be ordered exactly as shown in the generation process. Note that if an FC-BGP speaker uses multiple AS Numbers (e.g., the FC-BGP speaker is a member of a confederation), the AS number used here <span class="bcp14">MUST</span> be the AS number announced in the OPEN message for the BGP session over which the FC-BGP UPDATE message was received. All three AS numbers in one FC segment follow this rule.<a href="#section-5.2.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.1-7.3">
              <p id="section-5.2.1-7.3.1">Step 3: Use the signature validation algorithm (for the given algorithm suite) to verify the signature in the current segment. That is, invoke the signature validation algorithm on the following three inputs: the value of the signature field in the current FC segment, the digest value computed in Step 2 above, and the public key obtained from the valid RPKI data in Step 1 above. If the signature validation algorithm determines that the signature is invalid, then mark the entire FC segment as 'Not Valid' and stop.  If the signature validation algorithm determines that the signature is valid, then the FC segment is marked as 'Valid' and continues to process the following FC segments.<a href="#section-5.2.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.1-8">If all FC segments are marked as 'Valid', then the validation algorithm terminates and the FC-BGP UPDATE message is deemed 'Valid'. Otherwise, the FC-BGP UPDATE message is deemed 'Not Valid'.<a href="#section-5.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="implementations-operations-and-management-considerations">
<section id="section-6">
      <h2 id="name-implementations-operations-">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementations-operations-" class="section-name selfRef">Implementations, Operations, and Management Considerations</a>
      </h2>
<div id="algorithms-and-extensibility">
<section id="section-6.1">
        <h3 id="name-algorithms-and-extensibilit">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-algorithms-and-extensibilit" class="section-name selfRef">Algorithms and Extensibility</a>
        </h3>
<p id="section-6.1-1">The content of Algorithm Suite Considerations defined in <span><a href="https://rfc-editor.org/rfc/rfc8205#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> and content of Considerations for the SKI Size defined in <span><a href="https://rfc-editor.org/rfc/rfc8205#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> are indeed applicable in this context of FC-BGP.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">But the algorithm suite transition in FC-BGP is straightforward: As each FC segment has an Algorithm ID field, just populate this field with a feasible and consensus value that all FC-BGP speaker supports when transitioning.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="speedup-and-early-termination-of-signature-verification">
<section id="section-6.2">
        <h3 id="name-speedup-and-early-terminati">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-speedup-and-early-terminati" class="section-name selfRef">Speedup and Early Termination of Signature Verification</a>
        </h3>
<p id="section-6.2-1">It is advantageous for an implementation to establish a parallel verification process for FC-BGP if the router's processor supports such operations. As each FC segment contains the integral data that needs to be verified, parallel verification can significantly enhance the efficiency and speed of the validation process. By utilizing parallel processing capabilities, an implementation can simultaneously verify multiple FC segments, thereby reducing the overall verification time. This is particularly beneficial in scenarios where the FC path attribute contains a substantial number of segments or in high-traffic networks with a large volume of FC-BGP UPDATE messages. Implementations that leverage parallel verification take advantage of the processing power available in modern router processors. This allows for more efficient and faster verification, ensuring that the FC-BGP UPDATE messages are promptly validated and routed accordingly.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">However, it's important to note that the feasibility of parallel verification depends on the specific capabilities and constraints of the router's processor. Implementations <span class="bcp14">SHOULD</span> consider factors such as available resources, concurrency limitations, and the impact on overall system performance when implementing parallel verification processes. Overall, setting up a parallel verification process for FC-BGP, if feasible, can contribute to improved performance and responsiveness in validating FC segments, further enhancing the reliability and efficiency of the FC-BGP protocol.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">During the validation of an FC-BGP UPDATE message, route processor performance speedup can be achieved by incorporating the following observations. These observations provide valuable insights into optimizing the validation process and reducing the workload on the route processor. One of the key observations is that an FC-BGP UPDATE message is considered 'Valid' only if all FC segments are marked as 'Valid' in the validation steps. This means that if an FC segment is marked as 'Not Valid', there is no need to continue verifying the remaining unverified FC segments. This optimization can significantly reduce the processing time and workload on the route processor. Furthermore, when the FC-BGP UPDATE message is selected as the best path, the FC-BGP speaker appends its own FC segment, including the appropriate signature generated with the corresponding algorithm, to the FC path attribute. This ensures that the updated path is propagated correctly.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Additionally, an FC-BGP UPDATE message is considered as 'Not Valid' if at least one signature in each of the FC segments is invalid. Thus, the verification process for an FC segment can terminate early as soon as the first invalid signature is encountered. There is no need to continue validating the remaining signatures in that FC segment.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">By incorporating these observations, an FC-BGP implementation can achieve significant performance improvements and reduce the computational burden on the route processor. It allows for more efficient validation of FC-BGP UPDATE messages, ensuring the integrity and security of the routing information while maximizing system resources.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defering-validation">
<section id="section-6.3">
        <h3 id="name-defering-validation">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-defering-validation" class="section-name selfRef">Defering Validation</a>
        </h3>
<p id="section-6.3-1">When an FC-BGP speaker receives an exceptionally large number of UPDATE messages simultaneously, though it can use parallel verification to speed up the validation, it can be beneficial to defer the validation of incoming FC-BGP UPDATE messages. The decision to defer the validation process may depend on the local policy of the FC-BGP speaker, taking into account factors such as available resources and system load.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">By deferring the validation of these messages, the FC-BGP speaker can prioritize its processing power and resources to handle other critical tasks or ongoing operations. Deferring the validation allows the FC-BGP speaker to temporarily postpone the resource-intensive validation process until it can allocate sufficient resources to handle the influx of incoming messages effectively.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The implementation <span class="bcp14">SHOULD</span> provide visibility to the operator regarding the deferment of validation and the status of the deferred messages. This visibility enables the operator to have awareness of the deferred messages and understand the current state of the system. This information is crucial for monitoring and managing the FC-BGP speaker's behavior, ensuring that the operator can make informed decisions based on the system's status.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="BGP-route-selection">
<section id="section-6.4">
        <h3 id="name-bgp-route-selection">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-bgp-route-selection" class="section-name selfRef">BGP Route Selection</a>
        </h3>
<p id="section-6.4-1">While FC-BGP does modify the BGP route selection result, it is not the primary intention of FC-BGP to modify the BGP route selection process itself. Instead, FC-BGP focuses on providing an additional layer of validation and verification for BGP UPDATE messages.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">However, the handling of FC-BGP validation states, as well as the integration of FC-BGP with the BGP route selection, is indeed a matter of local policy. FC-BGP implementations <span class="bcp14">SHOULD</span> provide mechanisms that allow operators to define and configure their own local policies on a per-session basis. This flexibility enables operators to customize the behavior of FC-BGP based on their specific requirements and preferences.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">By allowing operators to set local policies, FC-BGP implementations empower them to control how the validation status of FC-BGP UPDATE messages influences the BGP route selection process. Operators may choose to treat FC-BGP validation status differently for UPDATE messages received over different BGP sessions, based on their network's needs and security considerations.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">To ensure consistency and interoperability, it is <span class="bcp14">RECOMMENDED</span> that FC-BGP implementations treat the priority of FC-BGP UPDATE messages at the same level as Route Origin Validation (ROV). This means that the validation status of FC-BGP UPDATE messages should be considered alongside other route selection criteria, such as path attributes, AS path length, and local preference.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-deterministic-signature-algorithms">
<section id="section-6.5">
        <h3 id="name-non-deterministic-signature">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-non-deterministic-signature" class="section-name selfRef">Non-deterministic Signature Algorithms</a>
        </h3>
<p id="section-6.5-1">The non-deterministic nature of many signature algorithms can introduce variations in the signatures produced, even when signing the same data with the same key. This means that if an FC-BGP router receives two FC-BGP UPDATE messages from the same peer, for the same prefix, with the same FC path attribute except the signature fields, the signature fields <span class="bcp14">MAY</span> differ when using a non-deterministic signature algorithm. Note that if the sender caches and reuses the previous signature, the two sets of signature fields will not differ. This applies specifically to deterministic signature algorithms, where the signature fields between the two UPDATE messages <span class="bcp14">MUST</span> be identical.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">Considering these observations, an FC-BGP implementation <span class="bcp14">MAY</span> incorporate optimizations in the UPDATE validation processing. These optimizations can take advantage of the non-deterministic nature of signature algorithms to reduce computational overhead. For example, if an FC-BGP router has already validated an FC segment and its corresponding signature in a previous UPDATE message from the same peer, it may choose to cache and reuse the previous validation result. This can help avoid redundant computations for subsequent UPDATE messages with the same FC path attribute and SKIs, as long as the sender does not generate new signatures.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">By incorporating such optimizations, an implementation can reduce the computational load and processing time needed for validating FC-BGP UPDATE messages. However, it is important to ensure that the implementation adheres to the requirements and specifications of the FC-BGP protocol while considering the performance benefits of these optimizations.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="private-as-numbers">
<section id="section-6.6">
        <h3 id="name-private-as-numbers">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-private-as-numbers" class="section-name selfRef">Private AS Numbers</a>
        </h3>
<p id="section-6.6-1">The process of Private AS Numbers used in BGPsec speaker defined in <span><a href="https://rfc-editor.org/rfc/rfc8205#section-7.5." class="relref">Section 7.5.</a> of [<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> also applies here.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="robustness-considerations-for-accessing-rpki-data">
<section id="section-6.7">
        <h3 id="name-robustness-considerations-f">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-robustness-considerations-f" class="section-name selfRef">Robustness Considerations for Accessing RPKI Data</a>
        </h3>
<p id="section-6.7-1">As there is a mature RPKI to Router protocol <span>[<a href="#RFC8210" class="cite xref">RFC8210</a>]</span>, the implementation is <span class="bcp14">REQUIRED</span> to use this protocol to access the RPKI data. The content defined in <span><a href="https://rfc-editor.org/rfc/rfc8205#section-7.6." class="relref">Section 7.6.</a> of [<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> also applies here.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="graceful-restart">
<section id="section-6.8">
        <h3 id="name-graceful-restart">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-graceful-restart" class="section-name selfRef">Graceful Restart</a>
        </h3>
<p id="section-6.8-1">During Graceful Restart (GR), restarting and receiving FC-BGP speakers <span class="bcp14">MUST</span> follow the procedures specified in <span>[<a href="#RFC4724" class="cite xref">RFC4724</a>]</span> for restarting and receiving BGP speakers, respectively. In particular, the behavior of retaining the forwarding state for the routes in the Loc-RIB <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> and marking them as stale, as well as not differentiating between stale routing information and other information during forwarding, will be the same as the behavior specified in <span>[<a href="#RFC4724" class="cite xref">RFC4724</a>]</span>.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="robustness-of-secret-random-number-in-ecdsa">
<section id="section-6.9">
        <h3 id="name-robustness-of-secret-random">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-robustness-of-secret-random" class="section-name selfRef">Robustness of Secret Random Number in ECDSA</a>
        </h3>
<p id="section-6.9-1">As both FC-BGP and BGPsec use ECDSA, the content of Robustness of Secret Random Number in ECDSA defined in <span><a href="https://rfc-editor.org/rfc/rfc8205#section-7.8." class="relref">Section 7.8.</a> of [<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> applies here.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comparison">
<section id="section-6.10">
        <h3 id="name-incremental-partial-deploym">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-incremental-partial-deploym" class="section-name selfRef">Incremental/Partial Deployment Considerations</a>
        </h3>
<p id="section-6.10-1">The core difference between FC-BGP and BGPsec is that BGPsec is a path-level authentication approach whereas FC-BGP is a pathlet-driven authentication approach.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
<p id="section-6.10-2">In design, FC-BGP does not modify the AS_PATH attribute. It defines a new transitive path attribute to transport the FC segments so that the legacy ASes can forward this attribute to its peers. Thus, FC-BGP is natively compatible with the BGP and supports partial deployment. It differs from BGPsec which replaces the AS_PATH attribute with a new Secure_Path information of BGPsec_Path attribute.<a href="#section-6.10-2" class="pilcrow">¶</a></p>
<p id="section-6.10-3">As for incremental/partial deployment considerations, in Section 5.1.1 of <span>[<a href="#ARXIV" class="cite xref">ARXIV</a>]</span>, we have proved that the adversary cannot forge a valid AS path when FC-BGP is universally deployed. Section 5.1.2 of <span>[<a href="#ARXIV" class="cite xref">ARXIV</a>]</span> analyzes the benefits of FC-BGP in case of partial deployment. The results show that FC-BGP provides more benefits than BGPsec in partial deployment. As a result, attackers are forced to pretend to be at least two hops away from the destination AS, which reduces the probability of successful path hijacks.<a href="#section-6.10-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="security-guarantees">
<section id="section-7.1">
        <h3 id="name-security-guarantees">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-security-guarantees" class="section-name selfRef">Security Guarantees</a>
        </h3>
<p id="section-7.1-1">TBD.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">When FC-BGP is used in conjunction with origin validation, the following security guarantees can be achieved:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">
            <p id="section-7.1-3.1.1">The source AS in a route announcement is authorized.<a href="#section-7.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">FC-BGP speakers on the AS-Path are authorized to propagate the route announcements.<a href="#section-7.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.3">
            <p id="section-7.1-3.3.1">The forwarding path of packets is consistent with the routing path announced by the FC-BGP speakers.<a href="#section-7.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-4">FC-BGP is designed to enhance the security of control plane routing in the Internet at the network layer. Specifically, FC-BGP allows an AS to independently prove its BGP routing decisions with publicly verifiable cryptography commitments, based on which any on-path AS can verify the authenticity of a BGP path. More crucially, the above security guarantees offered by FC-BGP are not binary, i.e., secure or non-secure. Instead, the security benefits are strictly monotonically increasing as the deployment rate of FC-BGP (i.e., the percentage of ASs that are upgraded to support FC-BGP) increases.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mitigation-of-denial-of-service-attacks">
<section id="section-7.2">
        <h3 id="name-mitigation-of-denial-of-ser">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mitigation-of-denial-of-ser" class="section-name selfRef">Mitigation of Denial-of-Service Attacks</a>
        </h3>
<p id="section-7.2-1">The FC-BGP UPDATE process, due to its involvement in numerous cryptographic operations, becomes vulnerable to Denial-of-Service (DoS) attacks targeting FC-BGP speakers. This section addresses the mitigation strategies tailored for the specific DoS threats the FC-BGP protocol poses. To prevent the Denial-of-Service (DoS) attacks faced by the FC-BGP control plane mechanism, there is no need to put in more effort than BGPsec.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">To reduce the impact of DoS attacks, FC-BGP speakers <span class="bcp14">SHOULD</span> employ an UPDATE validation algorithm that prioritizes inexpensive checks (such as syntax checks) before proceeding to more resource-intensive operations (like signature verification). The validation algorithm described in <a href="#validation-steps" class="auto internal xref">Section 5.2.1</a> is designed to sequence checks in order of likely expense, starting with less costly operations. However, the actual cost of executing these validation steps can vary across different implementations, and the algorithm in <a href="#validation-steps" class="auto internal xref">Section 5.2.1</a> may not offer the optimal level of DoS protection for all cases.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">Moreover, the transmission of UPDATE messages with the FC path attribute, which entails a multitude of signatures, is a potential vector for denial-of-service attacks. To counter this, implementations of the validation algorithm must cease signature verification immediately upon encountering an invalid signature. This prevents prolonged sequences of invalid signatures from being exploited for DoS purposes. Additionally, implementations can further mitigate such attacks by limiting validation efforts to only those UPDATE messages that, if found to be valid, would be chosen as the best path. In other words, if an UPDATE message includes a route that would be disqualified by the best path selection process for some reason (such as an excessively long AS path), it is OPTIONALLY to determine its FC-BGP validity status.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-security-considerations">
<section id="section-7.3">
        <h3 id="name-additional-security-conside">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-additional-security-conside" class="section-name selfRef">Additional Security Considerations</a>
        </h3>
<div id="sec-three-asn">
<section id="section-7.3.1">
          <h4 id="name-three-as-numbers">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-three-as-numbers" class="section-name selfRef">Three AS Numbers</a>
          </h4>
<p id="section-7.3.1-1">An FC segment contains only partial path information and FCs in the FCList are independent. To prevent BGP Path Splicing attacks, we propose to use the triplet &lt;Previous AS Number, Current AS Number, Nexthop AS Number&gt; to locate the pathlet information.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">But if there is no previous hop, i.e., this is the origin AS that tries to add its FC segment to the BGP UPDATE message, the Previous AS Number <span class="bcp14">SHOULD</span> be populated with 0. But, carefully, AS 0 <span class="bcp14">SHOULD</span> only be used in this case.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<p id="section-7.3.1-3">In the context of BGP <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>, to detect an AS routing loop, it scans the full AS path (as specified in the AS_PATH attribute) and checks that the autonomous system number of the local system does not appear in the AS path. As outlined in <span>[<a href="#RFC7607" class="cite xref">RFC7607</a>]</span>, Autonomous System 0 was listed in the IANA Autonomous System Number Registry as "Reserved - May be used to identify non-routed networks". So, there should be no AS 0 in the AS_PATH attribute of the BGP UPDATE message. Therefore, AS 0 could be used to populate the PASN field when no previous AS hops in the AS path.<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="misc">
<section id="section-7.3.2">
          <h4 id="name-misc">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-misc" class="section-name selfRef">MISC</a>
          </h4>
<p id="section-7.3.2-1">For a discussion of the BGPsec threat model and related security considerations, please see <span>[<a href="#RFC7132" class="cite xref">RFC7132</a>]</span>. The security considerations of <span>[<a href="#RFC4272" class="cite xref">RFC4272</a>]</span> also apply to FC-BGP.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">TBD. Wait for IANA to assign FC-BGP-UPDATE-PATH-ATTRIBUTE-TYPE.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">TBD. Regist Flags. The leftmost bit is the Confed_Segment flag and the second highest/leftmost bit is the Route_Server flag in this document.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">AS number 0 is used here to populate the PASN in an FC segment where there is no previous hop for an AS, i.e., the origin AS when adding the FC segment to the FC-BGP UPDATE message.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4271">https://www.rfc-editor.org/rfc/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4724">[RFC4724]</dt>
        <dd>
<span class="refAuthor">Sangli, S.</span>, <span class="refAuthor">Chen, E.</span>, <span class="refAuthor">Fernando, R.</span>, <span class="refAuthor">Scudder, J.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Graceful Restart Mechanism for BGP"</span>, <span class="seriesInfo">RFC 4724</span>, <span class="seriesInfo">DOI 10.17487/RFC4724</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4724">https://www.rfc-editor.org/rfc/rfc4724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5656">[RFC5656]</dt>
        <dd>
<span class="refAuthor">Stebila, D.</span> and <span class="refAuthor">J. Green</span>, <span class="refTitle">"Elliptic Curve Algorithm Integration in the Secure Shell Transport Layer"</span>, <span class="seriesInfo">RFC 5656</span>, <span class="seriesInfo">DOI 10.17487/RFC5656</span>, <time datetime="2009-12" class="refDate">December 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5656">https://www.rfc-editor.org/rfc/rfc5656</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6480">[RFC6480]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span> and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"An Infrastructure to Support Secure Internet Routing"</span>, <span class="seriesInfo">RFC 6480</span>, <span class="seriesInfo">DOI 10.17487/RFC6480</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6480">https://www.rfc-editor.org/rfc/rfc6480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6482">[RFC6482]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span>, <span class="refAuthor">Kent, S.</span>, and <span class="refAuthor">D. Kong</span>, <span class="refTitle">"A Profile for Route Origin Authorizations (ROAs)"</span>, <span class="seriesInfo">RFC 6482</span>, <span class="seriesInfo">DOI 10.17487/RFC6482</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6482">https://www.rfc-editor.org/rfc/rfc6482</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6483">[RFC6483]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span> and <span class="refAuthor">G. Michaelson</span>, <span class="refTitle">"Validation of Route Origination Using the Resource Certificate Public Key Infrastructure (PKI) and Route Origin Authorizations (ROAs)"</span>, <span class="seriesInfo">RFC 6483</span>, <span class="seriesInfo">DOI 10.17487/RFC6483</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6483">https://www.rfc-editor.org/rfc/rfc6483</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6487">[RFC6487]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Michaelson, G.</span>, and <span class="refAuthor">R. Loomans</span>, <span class="refTitle">"A Profile for X.509 PKIX Resource Certificates"</span>, <span class="seriesInfo">RFC 6487</span>, <span class="seriesInfo">DOI 10.17487/RFC6487</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6487">https://www.rfc-editor.org/rfc/rfc6487</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6793">[RFC6793]</dt>
        <dd>
<span class="refAuthor">Vohra, Q.</span> and <span class="refAuthor">E. Chen</span>, <span class="refTitle">"BGP Support for Four-Octet Autonomous System (AS) Number Space"</span>, <span class="seriesInfo">RFC 6793</span>, <span class="seriesInfo">DOI 10.17487/RFC6793</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6793">https://www.rfc-editor.org/rfc/rfc6793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7606">https://www.rfc-editor.org/rfc/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7947">[RFC7947]</dt>
        <dd>
<span class="refAuthor">Jasinska, E.</span>, <span class="refAuthor">Hilliard, N.</span>, <span class="refAuthor">Raszuk, R.</span>, and <span class="refAuthor">N. Bakker</span>, <span class="refTitle">"Internet Exchange BGP Route Server"</span>, <span class="seriesInfo">RFC 7947</span>, <span class="seriesInfo">DOI 10.17487/RFC7947</span>, <time datetime="2016-09" class="refDate">September 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7947">https://www.rfc-editor.org/rfc/rfc7947</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8205">https://www.rfc-editor.org/rfc/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8208">[RFC8208]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span> and <span class="refAuthor">O. Borchert</span>, <span class="refTitle">"BGPsec Algorithms, Key Formats, and Signature Formats"</span>, <span class="seriesInfo">RFC 8208</span>, <span class="seriesInfo">DOI 10.17487/RFC8208</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8208">https://www.rfc-editor.org/rfc/rfc8208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8209">[RFC8209]</dt>
        <dd>
<span class="refAuthor">Reynolds, M.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"A Profile for BGPsec Router Certificates, Certificate Revocation Lists, and Certification Requests"</span>, <span class="seriesInfo">RFC 8209</span>, <span class="seriesInfo">DOI 10.17487/RFC8209</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8209">https://www.rfc-editor.org/rfc/rfc8209</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8210">[RFC8210]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span> and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"</span>, <span class="seriesInfo">RFC 8210</span>, <span class="seriesInfo">DOI 10.17487/RFC8210</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8210">https://www.rfc-editor.org/rfc/rfc8210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8635">[RFC8635]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Router Keying for BGPsec"</span>, <span class="seriesInfo">RFC 8635</span>, <span class="seriesInfo">DOI 10.17487/RFC8635</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8635">https://www.rfc-editor.org/rfc/rfc8635</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4272">[RFC4272]</dt>
        <dd>
<span class="refAuthor">Murphy, S.</span>, <span class="refTitle">"BGP Security Vulnerabilities Analysis"</span>, <span class="seriesInfo">RFC 4272</span>, <span class="seriesInfo">DOI 10.17487/RFC4272</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4272">https://www.rfc-editor.org/rfc/rfc4272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5065">[RFC5065]</dt>
        <dd>
<span class="refAuthor">Traina, P.</span>, <span class="refAuthor">McPherson, D.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Autonomous System Confederations for BGP"</span>, <span class="seriesInfo">RFC 5065</span>, <span class="seriesInfo">DOI 10.17487/RFC5065</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5065">https://www.rfc-editor.org/rfc/rfc5065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5492">[RFC5492]</dt>
        <dd>
<span class="refAuthor">Scudder, J.</span> and <span class="refAuthor">R. Chandra</span>, <span class="refTitle">"Capabilities Advertisement with BGP-4"</span>, <span class="seriesInfo">RFC 5492</span>, <span class="seriesInfo">DOI 10.17487/RFC5492</span>, <time datetime="2009-02" class="refDate">February 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5492">https://www.rfc-editor.org/rfc/rfc5492</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6472">[RFC6472]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"Recommendation for Not Using AS_SET and AS_CONFED_SET in BGP"</span>, <span class="seriesInfo">BCP 172</span>, <span class="seriesInfo">RFC 6472</span>, <span class="seriesInfo">DOI 10.17487/RFC6472</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6472">https://www.rfc-editor.org/rfc/rfc6472</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6811">https://www.rfc-editor.org/rfc/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7132">[RFC7132]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">A. Chi</span>, <span class="refTitle">"Threat Model for BGP Path Security"</span>, <span class="seriesInfo">RFC 7132</span>, <span class="seriesInfo">DOI 10.17487/RFC7132</span>, <time datetime="2014-02" class="refDate">February 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7132">https://www.rfc-editor.org/rfc/rfc7132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7607">[RFC7607]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Schiller, H.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Codification of AS 0 Processing"</span>, <span class="seriesInfo">RFC 7607</span>, <span class="seriesInfo">DOI 10.17487/RFC7607</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7607">https://www.rfc-editor.org/rfc/rfc7607</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8416">[RFC8416]</dt>
        <dd>
<span class="refAuthor">Ma, D.</span>, <span class="refAuthor">Mandelberg, D.</span>, and <span class="refAuthor">T. Bruijnzeels</span>, <span class="refTitle">"Simplified Local Internet Number Resource Management with the RPKI (SLURM)"</span>, <span class="seriesInfo">RFC 8416</span>, <span class="seriesInfo">DOI 10.17487/RFC8416</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8416">https://www.rfc-editor.org/rfc/rfc8416</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ASPP">[ASPP]</dt>
        <dd>
<span class="refAuthor">McBride, M.</span>, <span class="refAuthor">Madory, D.</span>, <span class="refAuthor">Tantsura, J.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Li, H.</span>, <span class="refAuthor">Heitz, J.</span>, and <span class="refAuthor">G. S. Mishra</span>, <span class="refTitle">"AS Path Prepending"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-grow-as-path-prepending-12</span>, <time datetime="2024-02-07" class="refDate">7 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-grow-as-path-prepending-12">https://datatracker.ietf.org/doc/html/draft-ietf-grow-as-path-prepending-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ARXIV">[ARXIV]</dt>
      <dd>
<span class="refTitle">"Secure Inter-domain Routing and Forwarding via Verifiable Forwarding Commitments"</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://arxiv.org/abs/2309.13271">https://arxiv.org/abs/2309.13271</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.
Many many thanks to Keyur Patel and BGPsec authors.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ke Xu</span></div>
<div dir="auto" class="left"><span class="org">Tsinghua University</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:xuke@tsinghua.edu.cn" class="email">xuke@tsinghua.edu.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Xiaoliang Wang</span></div>
<div dir="auto" class="left"><span class="org">Tsinghua University</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wangxiaoliang0623@foxmail.com" class="email">wangxiaoliang0623@foxmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Zhuotao Liu</span></div>
<div dir="auto" class="left"><span class="org">Tsinghua University</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:zhuotaoliu@tsinghua.edu.cn" class="email">zhuotaoliu@tsinghua.edu.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Qi Li</span></div>
<div dir="auto" class="left"><span class="org">Tsinghua University</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:qli01@tsinghua.edu.cn" class="email">qli01@tsinghua.edu.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jianping Wu</span></div>
<div dir="auto" class="left"><span class="org">Tsinghua University</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jianping@cernet.edu.cn" class="email">jianping@cernet.edu.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yangfei Guo</span></div>
<div dir="auto" class="left"><span class="org">Zhongguancun Laboratory</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:guoyangfei@zgclab.edu.cn" class="email">guoyangfei@zgclab.edu.cn</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
